import{d as Xe,N as et,J as tt,q as at,r as b,z as nt,e as p,x as O,a5 as ot,o as st,p as X,c as i,b as s,K as I,n as ee,f as t,i as L,t as c,m as P,j as d,w as be,v as lt,g as F,A,F as ye,E as ke,a0 as it,B as rt,C as ct,a4 as Se,a as l,_ as dt}from"./entry.0dc1f255.js";import{u as ut}from"./composables.2719be85.js";import{i as m,X as mt,p as pt,r as ht,S as ft,Y as _t,_ as E,y as gt}from"./index.e94cd8ca.js";import{L as vt,a as bt,t as yt,u as kt,l as Ct,_ as wt}from"./CalendarRecurringAppointments.vue_vue_type_style_index_0_lang.6361d8a9.js";import{Q as St,R as Dt,f as zt,S as Ce,T as xt,U as Lt,w as Mt}from"./TextElement.vue_vue_type_style_index_0_lang.0ceda01b.js";import{C as we,_ as qt}from"./FormComponent.vue_vue_type_style_index_0_lang.2f4f5332.js";const k=f=>(rt("data-v-1b4ccb13"),f=f(),ct(),f),Tt={id:"app",ref:"app"},Yt=["onSubmit"],Rt=["id"],Bt={key:0,class:"hl_widget-header"},Ot={key:0},It={key:1,class:"hl_widget-header"},Pt=k(()=>s("button",{type:"button",class:"hl_widget-close"},"\xD7",-1)),Ft={key:2,class:"hl_widget-header"},Et=k(()=>s("button",{type:"button",class:"hl_widget-close"},"\xD7",-1)),Vt={class:"hl_widget-wrapper"},Ut={key:0,class:"hl_widget-form"},$t={class:"hl_widget-step1"},At={key:0,class:"hl_form-group",style:{"max-width":"300px"}},Nt={class:"hl_widget--pick-date-time"},jt={class:"hl_widget--pick-date"},Ht={class:"cal-title"},Wt={key:0,class:"multiple-cal-container"},Zt={class:"option__desc"},Qt={class:"option__title"},Gt={class:"relative"},Jt={key:1,class:"no-slots-block"},Kt=k(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",class:"bi bi-chevron-right",viewBox:"0 0 16 16"},[s("path",{"fill-rule":"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"})],-1)),Xt={class:"timezone-picker-group"},ea={class:"option__desc"},ta={class:"option__title"},aa={class:"option_sub_title"},na={class:"details-item-step2"},oa=k(()=>s("svg",{width:"20",height:"20",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},[s("path",{fill:"339af0",d:"M1664 896v128q0 53-32.5 90.5t-84.5 37.5h-704l293 294q38 36 38 90t-38 90l-75 76q-37 37-90 37-52 0-91-37l-651-652q-37-37-37-90 0-52 37-91l651-650q38-38 91-38 52 0 90 38l75 74q38 38 38 91t-38 91l-293 293h704q52 0 84.5 37.5t32.5 90.5z"})],-1)),sa=[oa],la={key:0,class:"text-capitalize"},ia=["onClick"],ra={style:{cursor:"pointer","text-decoration":"underline",color:"#178af6"}},ca={class:"pointer"},da={key:0,class:"loader"},ua={key:1,class:"pick-hours--wrap"},ma={class:"pick-hours--am"},pa={key:0},ha=["id"],fa=["value","id","checked"],_a=["for","onClick","textContent"],ga=["onClick","disabled"],va={class:"pick-hours--pm"},ba={key:0},ya=["id"],ka=["value","id","checked"],Ca=["for","textContent","onClick"],wa=["onClick"],Sa={key:0,class:"hl_form-group has-error"},Da={class:"error"},za={class:"details-item"},xa=k(()=>s("svg",{width:"20",height:"20",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},[s("path",{fill:"339af0",d:"M1664 896v128q0 53-32.5 90.5t-84.5 37.5h-704l293 294q38 36 38 90t-38 90l-75 76q-37 37-90 37-52 0-91-37l-651-652q-37-37-37-90 0-52 37-91l651-650q38-38 91-38 52 0 90 38l75 74q38 38 38 91t-38 91l-293 293h704q52 0 84.5 37.5t32.5 90.5z"})],-1)),La=[xa],Ma={key:1,class:"btn-back pl-0 pr-3 disable-back-btn"},qa=k(()=>s("svg",{width:"20",height:"20",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},[s("path",{fill:"339af0",d:"M1664 896v128q0 53-32.5 90.5t-84.5 37.5h-704l293 294q38 36 38 90t-38 90l-75 76q-37 37-90 37-52 0-91-37l-651-652q-37-37-37-90 0-52 37-91l651-650q38-38 91-38 52 0 90 38l75 74q38 38 38 91t-38 91l-293 293h704q52 0 84.5 37.5t32.5 90.5z"})],-1)),Ta=[qa],Ya={key:0,class:"mb-1 d-flex align-items-center mr-2 step3-btns step3-btns--ts-btn"},Ra=k(()=>s("svg",{width:"15",height:"15",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M1024 544v448q0 14-9 23t-23 9h-320q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h224v-352q0-14 9-23t23-9h64q14 0 23 9t9 23zm416 352q0-148-73-273t-198-198-273-73-273 73-198 198-73 273 73 273 198 198 273 73 273-73 198-198 73-273zm224 0q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"})],-1)),Ba={class:"mx-2"},Oa={key:0,class:"ml-2"},Ia={key:1,class:"d-flex align-items-center mb-1 step3-btns"},Pa=k(()=>s("svg",{width:"15",height:"15",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M192 1664h1408v-1024h-1408v1024zm384-1216v-288q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v288q0 14 9 23t23 9h64q14 0 23-9t9-23zm768 0v-288q0-14-9-23t-23-9h-64q-14 0-23 9t-9 23v288q0 14 9 23t23 9h64q14 0 23-9t9-23zm384-64v1280q0 52-38 90t-90 38h-1408q-52 0-90-38t-38-90v-1280q0-52 38-90t90-38h128v-96q0-66 47-113t113-47h64q66 0 113 47t47 113v96h384v-96q0-66 47-113t113-47h64q66 0 113 47t47 113v96h128q52 0 90 38t38 90z"})],-1)),Fa={class:"ml-2 text-capitalize"},Ea={key:1},Va={key:4,class:"hl_widget-body"},Ua=["textContent"],$a={key:1},Aa={class:"hl_form-group"},Na=["placeholder"],ja={key:5,class:"hl_widget-body"},Ha={key:6,class:"hl_widget-body"},Wa={key:0,class:"hl_events-buttons"},Za=["href"],Qa={xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"22",height:"22",viewBox:"0 0 48 48",style:{fill:"#000000"}},Ga=Se('<g id="surface1" data-v-1b4ccb13><path style="fill:#e0e0e0;" d="M 5.5 40.5 L 42.5 40.5 C 44.433594 40.5 46 38.933594 46 37 L 46 11 C 46 9.066406 44.433594 7.5 42.5 7.5 L 5.5 7.5 C 3.566406 7.5 2 9.066406 2 11 L 2 37 C 2 38.933594 3.566406 40.5 5.5 40.5 Z " data-v-1b4ccb13></path><path style="fill:#d9d9d9;" d="M 26 40.5 L 42.5 40.5 C 44.433594 40.5 46 38.933594 46 37 L 46 11 C 46 9.066406 44.433594 7.5 42.5 7.5 L 5.5 7.5 C 3.566406 7.5 2 9.066406 2 11 Z " data-v-1b4ccb13></path><path style="fill:#eeeeee;" d="M 6.746094 40.5 L 42.5 40.5 C 44.433594 40.5 46 38.933594 46 37 L 46 11.5 Z " data-v-1b4ccb13></path><path style="fill:#e0e0e0;" d="M 25.746094 40.5 L 42.5 40.5 C 44.433594 40.5 46 38.933594 46 37 L 46 11.5 L 18.769531 31.617188 Z " data-v-1b4ccb13></path><path style="fill:#ca3737;" d="M 42.5 9.5 L 5.5 9.5 C 3.566406 9.5 2 9.066406 2 11 L 2 37 C 2 38.933594 3.566406 40.5 5.5 40.5 L 7 40.5 L 7 12 L 41 12 L 41 40.5 L 42.5 40.5 C 44.433594 40.5 46 38.933594 46 37 L 46 11 C 46 9.066406 44.433594 9.5 42.5 9.5 Z " data-v-1b4ccb13></path><path style="fill:#f5f5f5;" d="M 42.5 7.5 L 5.5 7.5 C 3.566406 7.5 2 9.035156 2 11 C 2 12.207031 3.519531 13.257813 3.519531 13.257813 L 24 27.757813 L 44.480469 13.257813 C 44.480469 13.257813 46 12.207031 46 11 C 46 9.035156 44.433594 7.5 42.5 7.5 Z " data-v-1b4ccb13></path><path style="fill:#e84f4b;" d="M 43.246094 7.582031 L 24 21 L 4.753906 7.582031 C 3.179688 7.917969 2 9.296875 2 11 C 2 12.207031 3.519531 13.257813 3.519531 13.257813 L 24 27.757813 L 44.480469 13.257813 C 44.480469 13.257813 46 12.207031 46 11 C 46 9.296875 44.820313 7.917969 43.246094 7.582031 Z " data-v-1b4ccb13></path></g>',1),Ja=[Ga],Ka={class:"calendar-button__text"},Xa=["href"],en={xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"22",height:"22",viewBox:"0 0 48 48",style:{fill:"#000000"}},tn=Se('<g id="surface1" data-v-1b4ccb13><path style="fill:#03a9f4;" d="M 21 31 C 21 32.105469 21.894531 33 23 33 L 40 33 C 41.105469 33 42 32.105469 42 31 L 42 16 C 42 14.894531 41.105469 14 40 14 L 23 14 C 21.894531 14 21 14.894531 21 16 Z " data-v-1b4ccb13></path><path style="fill:#b3e5fc;" d="M 42 16.976563 L 42 16 C 42 15.570313 41.863281 15.175781 41.632813 14.851563 L 30.367188 21.785156 L 22.828125 17.128906 L 22.125 19 L 30.585938 24 Z " data-v-1b4ccb13></path><path style="fill:#0277bd;" d="M 27 41.460938 L 6 37.460938 L 6 9.460938 L 27 5.460938 Z " data-v-1b4ccb13></path><path style="fill:#ffffff;" d="M 21.214844 18.3125 C 20.117188 17.035156 18.671875 16.398438 16.886719 16.398438 C 14.996094 16.398438 13.480469 17.066406 12.335938 18.402344 C 11.191406 19.738281 10.613281 21.488281 10.613281 23.648438 C 10.613281 25.691406 11.179688 27.359375 12.304688 28.632813 C 13.429688 29.90625 14.898438 30.542969 16.683594 30.542969 C 18.523438 30.542969 20.015625 29.890625 21.15625 28.566406 C 22.300781 27.253906 22.867188 25.523438 22.867188 23.367188 C 22.867188 21.28125 22.316406 19.59375 21.214844 18.3125 Z M 19.050781 26.734375 C 18.480469 27.503906 17.710938 27.886719 16.734375 27.886719 C 15.796875 27.886719 15.035156 27.492188 14.449219 26.699219 C 13.871094 25.914063 13.582031 24.839844 13.582031 23.488281 C 13.582031 22.152344 13.871094 21.074219 14.449219 20.265625 C 15.035156 19.453125 15.820313 19.054688 16.804688 19.054688 C 17.769531 19.054688 18.523438 19.445313 19.074219 20.230469 C 19.628906 21.027344 19.90625 22.125 19.90625 23.539063 C 19.90625 24.90625 19.617188 25.96875 19.050781 26.734375 Z " data-v-1b4ccb13></path></g>',1),an=[tn],nn={class:"calendar-button__text"},on={key:7,class:"hl_widget-footer"},sn={key:0},ln=["onClick","disabled"],rn={key:8,class:"hl_widget-footer"},cn=["disabled"],dn=Xe({__name:"CalendarComponent",props:{calendarData:{type:Object,required:!0},redirect:{type:Boolean,default:!0},funnelPreview:{type:Boolean,default:!1},calendarElementClass:{type:String,required:!1},pageUrl:{type:String,default:void 0},baseReferrrer:{type:String,default:void 0},urlParams:{type:Object,default:void 0},stickyContactData:{type:Object,default:void 0},stickyContactFingerprint:{type:String,default:void 0}},emits:["on-submit","moveToNextMonth"],setup(f,{emit:De}){const N=f;m.extend(vt),m.extend(bt),m.extend(yt),m.extend(kt),m.extend(Ct);const{t:r,locale:S}=et(),_=tt(),D=at().public,te=D.baseUrl,j=b(),ae=b(),ne=b(),H=b(),V=b([]),oe=b(),se=b(),U=m.tz.guess(),z=b("en"),le=b(),e=nt({baseUrl:D.baseUrl,formData:{},calendarId:"",timezone:U,appointmentDate:m().tz(U).format("YYYY-MM-DD"),filterTimezone:"",availableTimezones:[],use24hTimezone:!1,selectedCalendar:null,allLocationData:[],events:[],daySlots:{},selectedSlot:null,isLoading:!0,notes:"",step:1,seqCall:0,serverError:"",popup:!1,eventId:void 0,event:void 0,fetchedMonth:null,AMVisibleSlot:4,PMVisibleSlot:4,openPayForm:!1,noCalendarError:!1,phone:"",checkboxRequiredStore:[],errorCheckboxList:[],checkBoxCheckedVal:[],stickyContact:!1,formLabelColor:"",buttonName:"Book appointment",selectedTimezone:"",timezones:mt,availableTime:[],calendarStartingDate:m().tz(U).format("YYYY-M-D"),calendarRange:{from:m().tz(U).subtract(2,"days").format("YYYY-M-D")},disableContactTimezone:!1,disableBackBtn:!1,showNoDates:!1,isNextMonthDisabled:!1,timezoneChangeState:!1,lang:void 0,startDayOfWeek:"1",noEventFound:!1,thanksMsg:void 0,appointmentIds:[],creatingAppointment:!1,showRecurringSlots:!1,loadingRecurringSlots:!1,recurringSlots:[]}),ze=()=>{le.value.showPopup()},xe=p(()=>{z.value;const n=[...m.weekdaysShort()];return n.push(n.shift()),n}),Le=p(()=>(z.value,m.months())),x=p(()=>(z.value,e.use24hTimezone?"HH:mm":"hh:mm A")),ie=p(()=>[{tag:"first_name",label:r("first_name"),active:!1,placeholder:r("first_name"),type:"text",required:!0},{placeholder:r("last_name"),type:"text",required:!0,tag:"last_name",label:r("last_name"),active:!1},{placeholder:r("phone"),type:"text",required:!0,tag:"phone",label:r("phone"),active:!1},{active:!1,type:"email",required:!0,placeholder:r("email"),tag:"email",label:r("email")},{label:"Button",tag:"button",type:"submit",placeholder:"Button"}]),Me=p(()=>{z.value;const a="Thank you for your appointment request. We will contact you shortly to confirm your request. Please call our office at ";return e.selectedCalendar&&(e.selectedCalendar.thanks_message||e.selectedCalendar.form_submit_thanks_message)?!(S.value!=="en"&&(e.selectedCalendar.thanks_message&&e.selectedCalendar.thanks_message.includes(a)||e.selectedCalendar.form_submit_thanks_message&&e.selectedCalendar.form_submit_thanks_message.includes(a))):!1}),M=p(()=>e.step<3);p(()=>e.selectedSlot?m().tz(e.selectedSlot,$.value).format():"NA");const q=p(()=>{var a;return e.disableContactTimezone?$.value:(a=e.selectedTimezone)==null?void 0:a.value}),$=p(()=>{if(e.selectedCalendar.id&&e.allLocationData[e.selectedCalendar.id]&&e.allLocationData[e.selectedCalendar.id].timezone)return e.allLocationData[e.selectedCalendar.id].timezone});p(()=>m(e.appointmentDate).tz(q.value));const qe=p(()=>(z.value,m(e.appointmentDate).format("ddd, ll"))),Te=p(()=>e.filterTimezone?e.availableTimezones.filter(a=>a.label.toLowerCase().includes(e.filterTimezone.toLowerCase())):e.availableTimezones),W=p(()=>xt(e.daySlots,m(e.appointmentDate).format("YYYY-MM-DD")+".slots",[]).map(n=>m(n).tz(q.value))),T=p(()=>W.value.filter(a=>a.hour()<12)),Y=p(()=>W.value.filter(a=>a.hour()>=12)),C=p(()=>Lt(e.allLocationData)?[]:Object.values(e.allLocationData).map(a=>a.calendar)),w=p(()=>{var a,n;if(((a=e.selectedCalendar)==null?void 0:a.id)&&((n=e.allLocationData[e.selectedCalendar.id])==null?void 0:n.calendar))return e.allLocationData[e.selectedCalendar.id].calendar}),re=p(()=>{var a,n;if(((a=e.selectedCalendar)==null?void 0:a.id)&&((n=e.allLocationData[e.selectedCalendar.id])==null?void 0:n.email))return e.allLocationData[e.selectedCalendar.id].email}),ce=p(()=>{var a,n;if(((a=e.selectedCalendar)==null?void 0:a.id)&&((n=e.allLocationData[e.selectedCalendar.id])==null?void 0:n.phone))return e.allLocationData[e.selectedCalendar.id].phone}),Ye=p(()=>{var a;return((a=e.selectedCalendar)==null?void 0:a.id)&&e.allLocationData[e.selectedCalendar.id]?e.allLocationData[e.selectedCalendar.id].country:"US"}),Re=p(()=>ce.value?ce.value:re.value?re.value:void 0),Z=p(()=>e.selectedCalendar?e.selectedCalendar.pixel_id:null),Be=p(()=>e.event?m(e.event.start_time).tz(q.value).format("ddd, ll"):null);O(()=>e.appointmentDate,a=>{a===void 0?e.events=[]:me()}),O(()=>W.value,a=>{e.selectedSlot=null});const Q=p(()=>Array.isArray(e.recurringSlots)&&e.recurringSlots.length);O(()=>e.selectedSlot,a=>{var n,o;try{if(!!((n=e.selectedCalendar)!=null&&n.recurringRule)&&a){e.showRecurringSlots=!0;const u=new Date(a).getTime();Ne(u,(o=e.selectedTimezone)==null?void 0:o.value)}else e.showRecurringSlots=!1,e.recurringSlots=[]}catch(u){console.error(u),e.showRecurringSlots=!1,e.recurringSlots=[]}}),O(()=>e.selectedTimezone,()=>{e.timezoneChangeState&&K({reset:!0})}),O(()=>e.selectedCalendar,async a=>{if(a.allow_booking_for_unit&&a.allow_booking_for){const n=m().tz(a.timezone).add(a.allow_booking_for,a.allow_booking_for_unit).endOf("day");e.calendarRange.to=m(n).tz(m.tz.guess(),!0).format("YYYY-M-D")}e.lang===void 0&&a.language&&S!==a.language&&a.language!=="en"&&(S.value=a.language,await gt(`unpkg.com/dayjs@1.8.21/locale/${S.value}.js`,()=>{m.locale(S.value),z.value=S.value})),e.use24hTimezone||(e.use24hTimezone=a.use24hFormat),e.startDayOfWeek=a.startDayOfWeek,a.allow_booking_after_unit&&a.allow_booking_after_unit!=="hours"&&a.allow_booking_after&&(e.calendarRange.from=m().tz(a.timezone).add(a.allow_booking_after,a.allow_booking_after_unit).startOf("day").format("YYYY-M-D")),!N.funnelPreview&&Z.value!==void 0&&Z.value!==""&&X(()=>{Mt(Z.value)}),e.disableContactTimezone=a.disableContactTimezone,K({reset:!0,setAppointmentDate:!0}),Ue()}),_.query.use24hFormat&&(e.use24hTimezone=!0),_.query.lang&&(e.lang=_.query.lang),e.allLocationData=N.calendarData,e.calendarId=_.params.id,e.popup=_.query.popup,e.eventId=_.query.event_id,ot(()=>{G()});function G(){const a=j.value;if(!!a){const n=parseInt(a.scrollHeight);window.parent.postMessage(["highlevel.setHeight",{height:n>500?n:560,id:"msgsndr-calendar"}],"*")}}st(async()=>{window.dayjs=m,Fe(),await Ee(),X(()=>{if(e.selectedCalendar&&e.selectedCalendar.code_block){const a=document.createRange();a.setStart(document.head,0),document.body.appendChild(a.createContextualFragment(e.selectedCalendar.code_block))}Ge()}),setTimeout(()=>{G()},2e3)});function J(a,n,o){const u=a.scrollTop,g=n-u;let h=0;const y=20,B=function(v,ge,ve,Ke){return v/=Ke/2,v<1?ve/2*v*v+ge:(v--,-ve/2*(v*(v-2)-1)+ge)},_e=function(){h+=y;const v=B(h,u,g,o);a.scrollTop=v,h<o&&setTimeout(_e,y)};_e()}function de(a){return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}function Oe(a){const{to:n,from:o}=e.calendarRange;return n&&new Date(de(a))>new Date(n)||o&&new Date(de(a))<new Date(o)?!0:e.availableTime.length>0?!e.availableTime.includes(a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()):!0}function Ie(){const a=ne.value;a&&J(a,a.offsetTop,500),(window.matchMedia("only screen and (max-width: 649px)").matches||a.closest(".hl-app-mobile"))&&(H.value.className+=" selected-date")}function Pe(){H.value.classList.remove("selected-date")}function ue(a){let n=0;a==="am"?(e.AMVisibleSlot+6>=T.value.length?(n=(T.value.length-1)%5,e.AMVisibleSlot=-1):(n=5,e.AMVisibleSlot=e.AMVisibleSlot+5),n<5&&(n=0)):(e.PMVisibleSlot+6>=Y.value.length?(n=(Y.value.length-1)%5,e.PMVisibleSlot=-1):(n=5,e.PMVisibleSlot=e.PMVisibleSlot+5),n<5&&(n=0));const o=V.value["pick-hours--"+a];if(o){const u=n>0?parseFloat(o.scrollTop)+n*49:0;J(o,u,500)}}function me(){pe("am"),pe("pm")}function pe(a){const n=V.value["pick-hours--"+a];n&&J(n,0,500)}function Fe(){e.timezones.includes(e.timezone)||e.timezones.push(e.timezone),e.availableTimezones=St(e.timezones.map(a=>{const n=m().tz(a);return{label:`GMT${n.format("Z")} ${a} (${n.format("z")})`,sortFormat:n.format("z"),value:a,currentTime:n.format(x.value),utcOffset:n.utcOffset()}}),"utcOffset"),e.selectedTimezone=e.availableTimezones.find(a=>{const n=e.disableContactTimezone?$.value:e.timezone;return a.value===n})}async function Ee(){if(C.value.length===0){e.step=4,e.noCalendarError=!0;return}const a=C.value.findIndex(n=>{const o=_.query.calendar;return n.id===_.query.calendar&&o.split(",")[0]});a>-1?e.selectedCalendar=C.value[a]:e.selectedCalendar=C.value[0];try{if(e.selectedCalendar.enable_recurring){const{booking_option:n,booking_overlap_default_status:o,...u}=e.selectedCalendar.recurring,g={freq:u.freq,count:u.count,interval:u.interval||1,monthDays:u.month_days,weekDays:u.week_days},h=await we.generateRRuleText(g);e.selectedCalendar.recurringRule=(h[0].toUpperCase()+h.slice(1)).replace("time","occurrence")}}catch(n){console.error(n),e.selectedCalendar.recurringRule="-"}e.disableContactTimezone=w.value.disableContactTimezone,e.selectedTimezone=e.availableTimezones.find(n=>e.disableContactTimezone?n.value===$.value:n.value===e.timezone),$e()}function Ve(){const a={},n=ie.value;return a.form=[],e.selectedCalendar.stripe&&n.splice(ie.value.length-1,0,{tag:"payment",label:r("payment"),active:!1,placeholder:"",type:"payment",required:!0}),a.form={width:"550",formLabelVisible:!0,fbPixelId:"",layout:!1,customStyle:"",stickyContact:!!e.selectedCalendar.sticky_contact,fields:n,align:"center"},a.country=Ye.value,a.locationId=e.selectedCalendar.location_id,a}async function Ue(){var a;if(e.selectedCalendar&&e.selectedCalendar.form_id){const n=D.newBaseURL+"/form/"+e.selectedCalendar.form_id,o=await $fetch(n),u=(a=o==null?void 0:o.form)==null?void 0:a.fields;u&&u.length>0&&(u[u.length-1],o.form.button={background:"#188bf6",color:"#fff",border:{border:0,padding:15,radius:4}},e.selectedCalendar.stripe&&u.push({tag:"payment",label:"Payment",active:!1,placeholder:"",type:"payment",required:!0})),e.formData=o}e.selectedCalendar&&!e.selectedCalendar.form_id&&(e.formData=Ve())}function he({month:a,year:n}){e.calendarStartingDate=`${n}-${a+1}-1`,K({reset:!1})}async function K({reset:a=!1,setAppointmentDate:n=!1}){e.AMVisibleSlot=-1,e.PMVisibleSlot=-1,me(),e.isLoading=!0,e.events=[],a&&(e.daySlots={}),e.showNoDates=!1,e.seqCall++;const o=m(e.calendarStartingDate,"YYYY-M-D"),u=o.clone().startOf("month"),g=o.clone().endOf("month"),h=await $fetch(D.newBaseURL+"/appointment/free-slots",{params:{calendar_id:e.selectedCalendar.id,startDate:u.valueOf(),endDate:g.valueOf(),timezone:q.value}});console.log("fetchCalendarSlots",h.seqCall,e.seqCall),e.daySlots={...e.daySlots,...h},e.availableTime=Object.keys(h).map(B=>m(B).format("YYYY-M-D"));const y=Object.keys(h);n&&y.length>0?m(y[0],"YYYY-M-D").isSame(m(e.calendarStartingDate,"YYYY-M-D"),"month")&&(e.appointmentDate=Object.keys(h)[0]):y.length===0&&(e.showNoDates=!0),e.isLoading=!1,e.timezoneChangeState=!0}async function $e(){if(!!e.eventId)try{const a=await $fetch(D.baseUrl+"/appointment/"+e.eventId);a?e.event=a:e.noEventFound=!0}catch{e.noEventFound=!0}}const Ae=p(()=>Q.value&&e.recurringSlots.filter(a=>!a.isUnavailable).length);async function Ne(a,n){e.loadingRecurringSlots=!0;const o=await we.getRecurringSlots(e.selectedCalendar.id,{selectedSlot:a,timezone:n});e.recurringSlots=o.map(u=>{const g=m(u.slot).format("ddd, ll"),h=m(u.slot).tz(n),y=h.format(x.value),B=h.clone().add(e.selectedCalendar.slot_duration,"m").format(x.value);return{text:`${g} [ ${y} - ${B} ]`,isUnavailable:u.status!=="AVAILABLE"}}),e.loadingRecurringSlots=!1}function R(){const a=oe.value;e.step===1&&e.selectedSlot?(e.step++,a&&a.querySelector("input").setAttribute("autofocus","true")):e.step===2||e.step++,setTimeout(()=>{G()},100)}function je(a){e.disableBackBtn=a.disable}function He(a){X(()=>{zt("track","Schedule",(a==null?void 0:a.fbEventId)||"")});const n=_.query.redirect||void 0;if(window.parent.postMessage(["msgsndr-booking-complete",{fingerprint:a.fingerprint,calendarId:w.value.id}],"*"),n==="false"||n===!1||N.redirect===!1){De("on-submit",a);return}if(a&&a.calendarThankYouUrl){const o=pt(e.selectedCalendar.location_id);window.top.location.href=ht(a.calendarThankYouUrl,o);return}(e.selectedCalendar.form_submit_thanks_message||e.selectedCalendar.thanks_message)&&(e.thanksMsg=ft(e.selectedCalendar.form_submit_thanks_message||e.selectedCalendar.thanks_message,a.cookiePayload)),Q.value?e.appointmentIds=[...a.ids]:e.appointmentIds=[a.id],e.creatingAppointment=!1,e.step++}function We(a){e.serverError=a.error}async function Ze(){if(e.step++,e.notes){e.isLoading=!0;const a={notes:e.notes};await Promise.all(e.appointmentIds.map(async n=>{const o=D.baseUrl+"/appointment/"+n+"/note";await $fetch(o,{method:"POST",body:a})})),e.isLoading=!1}}function fe(){window.self!==window.top&&parent.postMessage(["highlevel.closeWindow"],"*");const a=j.value;a&&_t(a,30)}function Qe(a){e.isNextMonthDisabled=a}function Ge(){{let a=se.value;a.clientWidth<650&&window.innerWidth>650?a.classList.add("hl-app-mobile"):a.classList.contains("hl-app-mobile")&&a.classList.remove("hl-app-mobile")}}const Je=p(()=>{var a,n;return((a=w.value)==null?void 0:a.stripe)&&Object((n=w.value)==null?void 0:n.stripe).hasOwnProperty("amount")});return ut(()=>{if(Je)return{script:[{src:"https://js.stripe.com/v3/",async:!0,type:"text/javascript"}]}}),(a,n)=>(l(),i("div",{class:"hl-app",ref_key:"calendarElementRef",ref:se},[s("div",Tt,[s("form",{onSubmit:I(R,["prevent"])},[s("div",{ref_key:"hlWidget",ref:j,class:ee(["hl_widget",{"--small":!t(M),"white-bg":!t(e).popup},{popup:t(e).popup}]),id:t(M)?"hl_widget":"hl_widget-requested"},[s("div",{ref_key:"hlWidgetInner",ref:H,class:ee([{"no-shadow ":!t(e).popup},"hl_widget-inner"])},[t(M)&&t(e).popup?(l(),i("div",Bt,[s("h2",null,[L(c(t(e).event?t(r)("reschedule_current_time",{time:t(Be)}):t(r)("appointment_request_form"))+" ",1),t(w)?(l(),i("span",Ot,c(t(w).name),1)):(l(),P(E,{key:1,color:"#607179",size:"20px",style:{display:"inline-block","margin-bottom":"-2px","margin-left":"5px"}}))]),s("button",{onClick:fe,type:"button",class:"hl_widget-close"}," \xD7 ")])):t(e).popup&&t(e).step===3?(l(),i("div",It,[s("h2",null,c(t(r)("appointment_requested")),1),Pt])):t(e).popup&&t(e).step===4?(l(),i("div",Ft,[s("h2",null,c(t(r)("thank_you")),1),Et])):d("",!0),t(M)?(l(),i("div",{key:3,class:ee(["hl_widget-body",{"step-form":t(e).step===2}])},[s("div",Vt,[!t(e).eventId||t(e).event&&t(e).event._id?(l(),i("div",Ut,[be(s("div",$t,[t(C).length>1?(l(),i("div",At)):d("",!0),s("div",Nt,[s("div",jt,[s("h3",Ht,c(t(r)("pick_a_date_and_time")),1),t(C).length>1?(l(),i("div",Wt,[F(t(Ce),{modelValue:t(e).selectedCalendar,"onUpdate:modelValue":n[0]||(n[0]=o=>t(e).selectedCalendar=o),options:t(C),allowEmpty:!1,"show-labels":!1,closeOnSelect:!0,label:"name",class:"multi_select_calendar"},{option:A(({option:o})=>[s("div",Zt,[s("span",Qt,c(o.name),1)])]),noResult:A(()=>[L(c(t(r)("no_calendar_found")),1)]),_:1},8,["modelValue","options"])])):d("",!0),s("div",Gt,[t(e).appointmentDate?(l(),P(Dt,{key:0,ref_key:"datePickerRef",ref:ae,modelValue:t(e).appointmentDate,"onUpdate:modelValue":[n[1]||(n[1]=o=>t(e).appointmentDate=o),Ie],format:"YYYY-MM-DD",displayFormat:"YYYY-MM-DD",hasInputElement:!1,isDateDisabled:Oe,disablePeriodControl:!0,calendarRange:t(e).calendarRange,onChangedMonth:he,onChangedYear:he,placeholder:t(r)("date_of_birth"),class:"date-picker-calendar",onDisableNextMonth:Qe,weekdays:t(xe),months:t(Le),startDayOfWeek:t(e).startDayOfWeek,nextMonthCaption:t(r)("next_month"),prevMonthCaption:t(r)("previous_month")},null,8,["modelValue","calendarRange","placeholder","weekdays","months","startDayOfWeek","nextMonthCaption","prevMonthCaption"])):d("",!0),!t(e).isLoading&&t(e).showNoDates?(l(),i("div",Jt,[t(e).isNextMonthDisabled?d("",!0):(l(),i("a",{key:0,onClick:n[2]||(n[2]=o=>t(ae).incrementMonth())},[L(c(t(r)("go_to_next_month"))+" ",1),Kt])),s("div",null,c(t(r)("no_slot_available_this_month")),1)])):d("",!0)]),s("div",Xt,[t(e).disableContactTimezone?d("",!0):(l(),P(t(Ce),{key:0,modelValue:t(e).selectedTimezone,"onUpdate:modelValue":n[3]||(n[3]=o=>t(e).selectedTimezone=o),closeOnSelect:!0,allowEmpty:!1,"show-labels":!1,options:t(Te),label:"label",placeholder:t(r)("timezone"),class:"multi_select_calendar"},{option:A(({option:o})=>[s("div",ea,[s("span",ta,c(o.label),1),s("span",aa,c(o.currentTime),1)])]),noResult:A(()=>[L(c(t(r)("no_timezone_found")),1)]),_:1},8,["modelValue","options","placeholder"]))])]),s("div",{ref_key:"appointmentSlots",ref:ne,id:"appointmentSlots",class:"hl_widget--pick-hours d_none"},[s("div",na,[s("div",{class:"pick-date-title"},[s("span",{onClick:Pe,class:"pr-3 back_button"},sa)]),s("h3",null,[L(c(t(r)("available_starting_times_for"))+" ",1),t(e).appointmentDate?(l(),i("strong",la,c(t(qe)),1)):d("",!0),t(e).loadingRecurringSlots?(l(),P(E,{key:1,loading:!0,color:"#178AF6",size:"25px"})):t(Q)?(l(),i("div",{key:2,onClick:I(ze,["stop","prevent"])},[s("div",ra,[s("span",ca," +"+c(t(Ae)-1)+" more ",1)]),F(wt,{ref_key:"recurringModalRef",ref:le,recurringSlots:t(e).recurringSlots,recurrenceCount:t(e).selectedCalendar.recurring.count},null,8,["recurringSlots","recurrenceCount"])],8,ia)):d("",!0)])]),t(e).isLoading?(l(),i("div",da,[F(E,{loading:!0,color:"#188bf6",size:"30px"})])):d("",!0),t(e).isLoading?d("",!0):(l(),i("div",ua,[s("div",ma,[s("h4",null,c(t(r)("am")),1),t(T).length?d("",!0):(l(),i("p",pa,c(t(r)("no_slots_available")),1)),s("div",{id:"pick-hours--am",ref:o=>t(V)["pick-hours--am"]=o},[(l(!0),i(ye,null,ke(t(T),(o,u)=>(l(),i("div",{id:"am"+u,key:u,class:"hour-select"},[s("input",{value:o.valueOf(),id:o.format("HH:mm"),checked:t(e).selectedSlot&&t(e).selectedSlot.valueOf()===o.valueOf(),type:"radio",name:"hour-select"},null,8,fa),s("label",{for:o.format("HH:mm"),onClick:g=>t(e).selectedSlot=o,textContent:c(o.format(t(x)))},null,8,_a),!t(e).isLoading&&t(e).step===1?(l(),i("button",{key:0,onClick:I(R,["prevent"]),type:"button",disabled:t(e).loadingRecurringSlots,class:"hl_select_button --primary"},c(t(e).loadingRecurringSlots?t(r)("fetching_recurring_slots"):t(r)("select_time")),9,ga)):d("",!0)],8,ha))),128))],512),t(T).length>5?(l(),i("a",{key:1,onClick:n[4]||(n[4]=o=>ue("am")),href:"javascript: void(0)",class:"load-more"},c(t(r)("load_more")),1)):d("",!0)]),s("div",va,[s("h4",null,c(t(r)("pm")),1),t(Y).length?(l(),i("div",{key:1,id:"pick-hours--pm",ref:o=>t(V)["pick-hours--pm"]=o},[(l(!0),i(ye,null,ke(t(Y),(o,u)=>(l(),i("div",{key:u,id:"pm"+u,class:"hour-select"},[s("input",{value:o.valueOf(),id:o.format("HH:mm"),checked:t(e).selectedSlot&&t(e).selectedSlot.valueOf()===o.valueOf(),type:"radio",name:"hour-select"},null,8,ka),s("label",{for:o.format("HH:mm"),textContent:c(o.format(t(x))),onClick:g=>t(e).selectedSlot=o},null,8,Ca),!t(e).isLoading&&t(e).step===1?(l(),i("button",{key:0,onClick:I(R,["prevent"]),type:"button",class:"hl_select_button --primary"},c(t(r)("select_time")),9,wa)):d("",!0)],8,ya))),128))],512)):(l(),i("p",ba,c(t(r)("no_slots_available")),1)),t(Y).length>5?(l(),i("a",{key:2,onClick:n[5]||(n[5]=o=>ue("pm")),href:"javascript: void(0)",class:"load-more"},c(t(r)("load_more")),1)):d("",!0)])]))],512)])],512),[[lt,t(e).step===1]]),t(e).step===2?(l(),i("div",{key:0,id:"form-builder",ref_key:"formBuilderRef",ref:oe,class:"form-builder--wrap"},[t(e).serverError?(l(),i("div",Sa,[s("span",Da,c(t(e).serverError),1)])):d("",!0),s("div",za,[t(e).disableBackBtn?d("",!0):(l(),i("span",{key:0,onClick:n[6]||(n[6]=o=>t(e).step=1),class:"btn-back pl-0 pr-3"},La)),t(e).disableBackBtn?(l(),i("span",Ma,Ta)):d("",!0),s("div",null,[t(e).selectedSlot?(l(),i("span",Ya,[Ra,s("span",Ba,c(t(e).selectedSlot.format(t(x)))+" ("+c(t(e).selectedTimezone.sortFormat)+") ",1),L(" - "),t(e).selectedCalendar&&t(e).selectedCalendar.slot_duration?(l(),i("span",Oa,c(t(e).selectedCalendar.slot_duration%60===0?t(e).selectedCalendar.slot_duration/60+" "+t(r)("hr"):t(e).selectedCalendar.slot_duration+" "+t(r)("minutes")),1)):d("",!0)])):d("",!0),t(e).selectedSlot?(l(),i("span",Ia,[Pa,s("span",Fa,c(t(e).selectedSlot.format("ddd, ll")),1)])):d("",!0)])]),F(qt,{timezone:t(q),formId:t(e).selectedCalendar.form_id,formElementClass:f.calendarElementClass,formData:t(e).formData,calendar:t(w),selectedSlot:t(e).selectedSlot,event:t(e).event,pageUrl:f.pageUrl,urlParams:f.urlParams,baseReferrrer:f.baseReferrrer,stickyContactData:f.stickyContactData,stickyContactFingerprint:f.stickyContactFingerprint,onStep:He,onProcessError:We,onDisableBackOnSubmit:je,class:"hl_widget-step2",funnelPreview:f.funnelPreview},null,8,["timezone","formId","formElementClass","formData","calendar","selectedSlot","event","pageUrl","urlParams","baseReferrrer","stickyContactData","stickyContactFingerprint","funnelPreview"])],512)):d("",!0)])):d("",!0),t(e).noEventFound?(l(),i("div",Ea,c(t(r)("no_calendar_event_found")),1)):d("",!0)])],2)):t(e).step===3?(l(),i("div",Va,[t(Me)?(l(),i("p",{key:0,textContent:c(t(e).thanksMsg||t(e).selectedCalendar.form_submit_thanks_message||t(e).selectedCalendar.thanks_message)},null,8,Ua)):(l(),i("p",$a,c(t(r)("thank_you_for_your_appointment_request"))+" "+c(t(r)("contact_you_shortly_with_contact_method",{contactMethod:t(Re)})),1)),s("div",Aa,[s("label",null,c(t(r)("additional_information")),1),be(s("textarea",{"onUpdate:modelValue":n[7]||(n[7]=o=>t(e).notes=o),class:"form-control",rows:"5",placeholder:t(r)("anything_youd_like_to_know_before_appointment")},null,8,Na),[[it,t(e).notes]])])])):t(e).noCalendarError?(l(),i("div",ja,[s("p",null,c(t(r)("cannot_find_calendar")),1)])):(l(),i("div",Ha,[t(e).appointmentIds&&t(e).appointmentIds.length?(l(),i("div",Wa,[s("a",{href:t(te)+`/google/calendar/add-event/${t(e).appointmentIds[0]}`,class:"calendar-button",target:"_blank"},[(l(),i("svg",Qa,Ja)),s("span",Ka,c(t(r)("add_to_google_calendar")),1)],8,Za),s("a",{href:t(te)+`/google/calendar/get-ics/${t(e).appointmentIds[0]}`,class:"calendar-button",target:"_blank"},[(l(),i("svg",en,an)),s("span",nn,c(t(r)("add_to_outlook_ical")),1)],8,Xa)])):d("",!0)])),t(M)&&(!t(e).eventId||t(e).event&&t(e).event._id)?(l(),i("div",on,[t(e).isLoading&&t(e).step==2?(l(),i("div",sn,[F(E,{loading:!0,color:"#188bf6",size:"30px"})])):d("",!0),!t(e).isLoading&&t(e).popup?(l(),i("button",{key:1,onClick:fe,type:"button",class:"hl_button hl_button-cancel"},c(t(r)("cancel")),1)):d("",!0),!t(e).isLoading&&t(e).step===1?(l(),i("button",{key:2,onClick:I(R,["prevent"]),disabled:!t(e).selectedSlot||t(e).isLoading||t(e).loadingRecurringSlots,class:"hl_button --primary --first-step",type:"button"},c(t(e).loadingRecurringSlots?t(r)("fetching_recurring_slots"):t(r)("select_date")),9,ln)):d("",!0)])):t(e).step===3?(l(),i("div",rn,[t(e).isLoading?d("",!0):(l(),i("button",{key:0,onClick:R,type:"button",class:"hl_button mr-2"},c(t(r)("skip")),1)),t(e).isLoading?d("",!0):(l(),i("button",{key:1,disabled:!t(e).notes,onClick:Ze,type:"button",class:"hl_button --primary"},c(t(r)("submit")),9,cn)),t(e).isLoading?(l(),P(E,{key:2,loading:!0,color:"#188bf6",size:"30px"})):d("",!0)])):d("",!0)],2)],10,Rt)],40,Yt)],512)],512))}});const gn=dt(dn,[["__scopeId","data-v-1b4ccb13"]]);export{gn as C};
